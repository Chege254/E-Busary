typeof jQuery!='undefined'&&(typeof ARK=='undefined'&&(ARK={}),jQuery(function($){'use strict';function getElement(a){return $.type(a)==='string'?$('#'+a):a.jquery&&a||$(a);}function getCompatElement(b){var a=b.ownerDocument||b.document||b;return!a.compatMode||a.compatMode=='CSS1Compat'?a.documentElement:a.body;}function getSize(b){var a=getCompatElement(b);return{x:a.clientWidth,y:a.clientHeight};}function getScroll(a){var b=$(a).is('window')?a:a.parentWindow||a.defaultView,c=getCompatElement(a);return{x:b.pageXOffset||c.scrollLeft,y:b.pageYOffset||c.scrollTop};}function getScrollSize(a){var b=getCompatElement(a),c=getSize(a),d=(a.ownerDocument||a.document||a).body;return{x:Math.max(b.scrollWidth,d.scrollWidth,c.x),y:Math.max(b.scrollHeight,d.scrollHeight,c.y)};}function parseJson(str,secure){return secure?$.parseJSON(str):eval('('+str+')');}if(typeof SqueezeBox=='object')return;ARK.squeezeBox={presets:{onOpen:function(){},onClose:function(){},onUpdate:function(){},onResize:function(){},onMove:function(){},onShow:function(){},onHide:function(){},size:{x:600,y:450},sizeLoading:{x:200,y:150},marginInner:{x:20,y:20},marginImage:{x:50,y:75},handler:!1,target:null,closable:!0,closeBtn:!0,zIndex:65555,overlayOpacity:0.7,classWindow:'',classOverlay:'',overlayFx:{},resizeFx:{},contentFx:{},parse:!1,parseSecure:!1,shadow:!0,overlay:!0,document:null,ajaxOptions:{},animate:{overlay:250,win:75,content:450},iframePreload:!1},initialize:function(b){if(this.options)return this;var a=$.extend({},this.presets,b);return this.doc=this.presets.document||document,this.options={},this.setOptions(a),this.build(),this.bound={window:$.proxy(this.reposition,this,[null]),scroll:$.proxy(this.checkTarget,this),close:$.proxy(this.close,this),key:$.proxy(this.onKey.bind,this)},this.isOpen=this.isLoading=!1,this;},addEvents:function(){var a=this;$.each(this,function(b,c){$.isFunction(c)&&/^on/.test(b)&&($(a).on(b,$.proxy(a.prop)),delete a.options[b]);});},setOptions:function(a){$.extend(this.options,this.presets,a||{}),this.addEvents();},build:function(){if(this.overlay=$('<div></div>').attr({id:'sbox-overlay','aria-hidden':'true',tabindex:-1}).css('z-index',this.options.zIndex),this.win=$('<div></div>').attr({id:'sbox-window',role:'dialog','aria-hidden':'true'}).css('z-index',this.options.zIndex+2),this.options.shadow){window.attachEvent&&!window.addEventListener||this.win.addClass('shadow');var a=$('<div></div>').attr({'class':'sbox-bg-wrap'}).appendTo(this.win);var b=$.proxy(function(a){this.overlay.trigger('click',[a]);},this);$.each(['n','ne','e','se','s','sw','w','nw'],function(d,c){$('<div></div>').attr({'class':'sbox-bg sbox-bg-'+c}).appendTo(a).click(b);});}this.content=$('<div></div>').attr({id:'sbox-content'}).appendTo(this.win),this.closeBtn=$('<a></a>').attr({id:'sbox-btn-close',href:'#',role:'button'}).appendTo(this.win),$(this.closeBtn).attr('aria-controls','sbox-window'),$(this.doc.body).append(this.overlay,this.win);},assign:function(a,c){var b=getElement(a);return(b.length&&b||$.type(a)==='string'&&$('.'+a)||$(null)).click(function(a){return a.preventDefault(),a.stopPropagation(),!ARK.squeezeBox.fromElement(this,c);});},open:function(d,f){if(this.initialize(),this.element!=null&&this.trash(),this.element=getElement(d)||!1,this.setOptions($.extend({},this.presets,f||{})),this.element&&this.options.parse){var a=$(this.element).attr(this.options.parse);a&&(a=parseJson(a,this.options.parseSecure))&&this.setOptions(a);}this.url=(this.element?this.element.attr('href'):d)||this.options.url||'',this.assignOptions();var b=b||this.options.handler;if(b)return this.setContent(b,this.parsers[b].call(this,!0));var e=!1;var c=this;return $.each(this.parsers,function(b,d){var a=d.call(c);return a?(e=c.setContent(b,a),!0):!1;});},fromElement:function(a,b){return this.open(a,b);},assignOptions:function(){$(this.overlay).addClass(this.options.classOverlay),$(this.win).addClass(this.options.classWindow);},close:function(a){var c=a!==void 0;if(c&&(a.stopPropagation(),a.preventDefault()),!this.isOpen)return this;if(c){var b=!1;if($.isFunction(this.options.closable)&&!this.options.closable.call(this,a)?b=!0:function(){return this.options.closable;}.call(this,a)||(b=!0),b)return this;}return $(this.overlay).fadeOut(this.options.animate.overlay,$.proxy(this.toggleOverlay,this)),$(this.win).attr('aria-hidden','true'),$(this).trigger('onClose',[this.content]),this.trash(),this.toggleListeners(),this.isOpen=!1,this;},trash:function(){return this.element=this.asset=null,$(this.content).empty(),this.options={},$(this).unbind()[0].setOptions(this.presets),$(this.closeBtn),this;},onError:function(){this.asset=null,this.setContent('string',this.options.errorMsg||'An error occurred');},setContent:function(a,b){return this.handlers[a]?(this.content[0].className='sbox-content-'+a,this.hideContent(),this.applyTimer=setTimeout($.proxy(function(){var c=this.handlers[a].call(this,b);c=$.isArray(c)?c:[c],this.applyContent.apply(this,c);},this),this.options.animate.overlay),$(this.overlay).data('opacity')?this:(this.toggleOverlay(!0),$(this.overlay).fadeTo(this.options.animate.overlay,this.options.overlayOpacity),this.reposition())):!1;},applyContent:function(a,c){if(!(this.isOpen||this.applyTimer))return;if(this.applyTimer=clearTimeout(this.applyTimer),!a)this.toggleLoading(!0);else{this.isLoading&&this.toggleLoading(!1);var b=this;setTimeout(function(){$(b).trigger('onUpdate',[b.content]);},20);}a&&$(this.content).append(a),this.isOpen?this.resize(c):(this.toggleListeners(!0),this.resize(c,!0),this.isOpen=!0,$(this.win).attr('aria-hidden','false'),$(this).trigger('onOpen',[this.content]));},resize:function(e,f){this.showTimer=clearTimeout(this.showTimer||null);var a=getSize(this.doc),b=getScroll(this.doc);this.size=$.extend(this.isLoading?this.options.sizeLoading:this.options.size,e);var d=getSize(self);if(this.size.x==d.x&&(this.size.y=this.size.y-50,this.size.x=this.size.x-20),a.x>979)var c={width:this.size.x,height:this.size.y,left:parseInt(b.x+(a.x-this.size.x-this.options.marginInner.x)/2),top:parseInt(b.y+(a.y-this.size.y-this.options.marginInner.y)/2)};else var c={width:a.x-40,height:a.y,left:parseInt(b.x+10),top:parseInt(b.y+20)};return this.hideContent(),f?($(this.win).css(c),this.showTimer=setTimeout($.proxy(this.showContent,this),50)):$(this.win).animate(c,this.options.animate.win,$.proxy(this.showContent,this)),this.reposition();},toggleListeners:function(b){var a=b?'on':'off';$(this.closeBtn)[a]('click',this.bound.close),$(this.overlay)[a]('click',this.bound.close),$(this.doc)[a]('keydown',this.bound.key)[a]('mousewheel',this.bound.scroll),$(this.doc.parentWindow||this.doc.defaultView)[a]('resize',this.bound.window)[a]('scroll',this.bound.window);},toggleLoading:function(a){this.isLoading=a,$(this.win)[a?'addClass':'removeClass']('sbox-loading'),a&&($(this.win).attr('aria-busy',a),$(this).trigger('onLoading',[this.win]));},toggleOverlay:function(a){if(this.options.overlay){var b=getSize(this.doc).x;$(this.overlay).attr('aria-hidden',a?'false':'true'),$(this.doc.body)[a?'addClass':'removeClass']('body-overlayed'),a?this.scrollOffset=getSize(this.doc.parentWindow||this.doc.defaultView).x-b:$(this.doc.body).css('margin-right','');}},showContent:function(){$(this.content).attr('opacity')&&$(this).trigger('onShow',[this.win]),$(this.content).fadeIn(this.options.animate.content,'easeOutExpo');},hideContent:function(){$(this.content).attr('opacity')||$(this).trigger('onHide',[this.win]),$(this.content).fadeOut(this.options.animate.content);},onKey:function(a){switch(a.key){case'esc':this.close(a);case'up':case'down':return!1;}},checkTarget:function(a){return a.target!==this.content&&$(this.content).find(a.target);},reposition:function(){var a=getSize(this.doc),c=getScroll(this.doc),b=getScrollSize(this.doc);var e=$(this.overlay).css('height');var d=parseInt(e);return b.y>d&&a.y>=d&&($(this.overlay).css({width:b.x+'px',height:b.y+'px'}),$(this.win).css({left:parseInt(c.x+(a.x-this.win.offsetWidth)/2-this.scrollOffset)+'px',top:parseInt(c.y+(a.y-this.win.offsetHeight)/2)+'px'})),$(this).trigger('onMove',[this.overlay,this.win]);},handlers:{},parsers:{}},$.extend(ARK.squeezeBox.parsers,{image:function(a){return a||/\.(?:jpg|png|gif)$/i.test(this.url)?this.url:!1;},clone:function(b){if(getElement(this.options.target))return getElement(this.options.target);if(this.element&&!this.element.parentNode)return this.element;var a=this.url.match(/#([\w-]+)$/);return a?getElement(a[1]):b?this.element:!1;},ajax:function(a){return a||this.url&&!/^(?:javascript|#)/i.test(this.url)?this.url:!1;},iframe:function(a){return a||this.url?this.url:!1;},string:function(a){return!0;}}),$.extend(ARK.squeezeBox.handlers,{image:function(c){var a,b=new Image();return this.asset=null,b.onload=b.onabort=b.onerror=$.proxy(function(){if(b.onload=b.onabort=b.onerror=null,!b.width){setTimeout($.proxy(this.onError,this),10);return;}var c=getSize(this.doc);c.x-=this.options.marginImage.x,c.y-=this.options.marginImage.y,a={x:b.width,y:b.height};for(var d=2;d--;)a.x>c.x?(a.y*=c.x/a.x,a.x=c.x):a.y>c.y&&(a.x*=c.y/a.y,a.y=c.y);a.x=parseInt(a.x),a.y=parseInt(a.y),this.asset=$(b),b=null,this.asset.attr('width',a.x),this.asset.attr('height',a.y),this.applyContent(this.asset,a);},this),b.src=c,b&&b.onload&&b.complete&&b.onload(),this.asset?[this.asset,a]:null;},clone:function(a){return a?$(a).clone():this.onError();},adopt:function(a){return a?a:this.onError();},ajax:function(c){function d(b){a.applyContent(b),$(a).trigger('onAjax',[b,a.asset]),a.asset=null;}var b=this.options.ajaxOptions||{};var a=this;this.asset=$.ajax($.extend({url:c,method:'GET',datatype:'html',cache:!1,async:!0,complete:function(b){b.status!=200?setTimeout(function(){a.onError.call(a);},10):setTimeout(function(){d(b.responseText);},setTimeout);}},b));},iframe:function(d){var a=getSize(this.doc);if(a.x>979){var b=this.options.size.x;var c=this.options.size.y;}else{var b=a.x;var c=a.y-50;}return this.asset=$('<iframe></iframe>').attr($.extend({src:d,frameBorder:0,width:b,height:c},this.options.iframeOptions||{})),this.options.iframePreload?(this.asset.on('load',$.proxy(function(){this.applyContent($(this.asset).css('display','')),this.asset.off('load');},this)),$(this.asset).css('display','none').appendTo(this.content),!1):this.asset;},string:function(a){return a;}}),ARK.squeezeBox.handlers.url=ARK.squeezeBox.handlers.ajax,ARK.squeezeBox.parsers.url=ARK.squeezeBox.parsers.ajax,ARK.squeezeBox.parsers.adopt=ARK.squeezeBox.parsers.clone,$.fn.squeezeBox=function(a,b){return b?ARK.squeezeBox.open(this,a):ARK.squeezeBox.assign(this,a);};}));